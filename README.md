# DKqual

## QUESTIONS FOR DANA KARWAS QUALIFIER - 11/2017
Data and additional resources are in https://github.com/fedhere/DKqual

### TIME SERIES ANALYSIS

Download the Maryland transportation data from the following link:
https://data.maryland.gov/Transportation/MTA-Average-Weekday-Ridership-by-Month/ub96-xxqw

This will give you data from July 2006 through June 2017. Plot the time series of average ridership for each mode of transportation. 
Answer question 1 and one of your choosing among the other two:
Find the most prominent event in the total ridership. Note: there are 2 prominent events (3-sigma outliers) in the “Total ridership” column reported in the data file, but only 1 of them appears in the time series generated by summing each individual mode of transportation*. That is the event of interest. Identify it**, identify the date, and, through an internet search answer: what was the cause of the largest anomaly in Maryland ridership 2006-2016?
Find the most prominent period*** in the time “Total ridership” time series.
Find the mode of transportation that increased in popularity, and the mode of transportation that decreased in popularity the most****. 
Predict the average ridership in 2020 by a simple (polynomial OLS) model.


* be careful not to double-count
** the anomaly is obvious, and you can spot it by eye. Preferably though, if time allows, you should identify it as a 3-sigma outlier through the following steps:
1. Fit a polynomial to the data to find the general trend
2. Remove the general trend found in 1 from the data
3. Calculate the mean and standard deviation of the data thus obtained
4. Identify points that deviate by more than 3 standard deviations from the mean
*** periodicity can be assessed through fourier transforms or with a periodogram
**** only use modes of transportation for which data are available for the majority of the time interval 2006-2016












### GEOSPATIAL ANALYSIS

When examining communication, especially communication of scientific information, it is important to understand the target audience’s access to information as well as the characteristics of the target audience to tune the message to them. 
Download the Census 2013 data for NYC 
broadband access (percentage of households with broadband access) and 
education level (percentage of population with bachelor or higher degree)
both at the PUMA (Public Use Microdata Area) geographical area level. 
Also download the 
PUMA areas shapefile for NYC. 
The data can be found here and here, or the versions that I downloaded here.

Create a choropleth* of NYC color-coded by access to broadband internet, chosing 5 levels of access: less than 50% households have access, 50-60, 60-70, 70-80, >80. 
Join the educational level data from the census with the broadband access data and cluster the NYC PUMA areas by these two variables**. Plot a choropleth of the cluster you obtained
Identify, if there are any, areas that have a different association than in the previous choropleth (i.e. where education and broadband access do not go hand in hand)

*you can use https://github.com/fedhere/choroplethNYC to facilitate the mapping
**you can use k-means clustering choosing 5 clusters, for an easy comparison with  the previous map. But if time allows also assess in a data-driven way what a good number of clusters would be, for example through a silhouette plot.




** tips and useful links:**

- the puma id is contained in the ACS data file, but the ACS id also contains the state id, 360 for NY. These ids are strings so to change the puma id to match the ACS id for a single row you can add the 360 piece as '360' + pumaid. To do that for all row you may want to use the function .apply(lambda x: '360' + x), or you can do it in a loop.

- when you merge make sure you merge the ACS dataframe into the puma geodataframe, and not viceversa:

  puma.merge(acsNY, right_on, left_on)
  
  you should then have 55 puma regions
  
- geopandas can be slow at calculating quartiles. you can calculate them in numpy with np.percentile. if the plotting is slow just leave the code line you would have used even if the plot is not rendered

- the education can be assessed as percentage of people with bachelor or higher degree from here 
https://factfinder.census.gov/faces/nav/jsf/pages/searchresults.xhtml?refresh=t#none and
https://factfinder.census.gov/faces/tableservices/jsf/pages/productview.xhtml?pid=ACS_16_1YR_S1501&prodType=table.

The download link here will provide the right data https://factfinder.census.gov/faces/nav/jsf/pages/searchresults.xhtml?refresh=t#none

the name of the column is the HC02_EST_VC18

to merge the eduation df with the puma geodf you need to pay attention to the data type of the id columns: turn the puma id into an integer for example to match the acsedu["GEO.id2"] type


puma["gid"] = (puma.id.values).astype(str)

also convert the acsedu["GEO.id2"] to string (may already be but it wont hurt) 

acsedu["gid"] = acsedu["GEO.id2"].astype(str)

then you can merge using  "gid"

